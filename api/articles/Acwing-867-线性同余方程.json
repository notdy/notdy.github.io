{"title":"Acwing 867 线性同余方程","uid":"0ed6b4d593b19a6383f83c1ccac6d61f","slug":"Acwing-867-线性同余方程","date":"2023-12-19T08:23:54.000Z","updated":"2023-12-19T08:29:43.584Z","comments":true,"path":"api/articles/Acwing-867-线性同余方程.json","keywords":null,"cover":[],"content":"<h1 id=\"题目描述\"><a href=\"#题目描述\" class=\"headerlink\" title=\"题目描述\"></a>题目描述</h1><blockquote>\n<p>给定 <code>n</code> 组数据 ai,bi,mi，对于每组数求出一个 xi，使其满足 ai×xi≡bi(modmi)，如果无解则输出 impossible。</p>\n<p>输入格式<br>第一行包含整数 n</p>\n<p>接下来 n 行，每行包含一组数据 ai,bi,mi</p>\n<p>输出格式<br>输出共 n<br> 行，每组数据输出一个整数表示一个满足条件的 xi，如果无解则输出 impossible。</p>\n<p>每组数据结果占一行，结果可能不唯一，输出任意一个满足条件的结果均可。</p>\n<p>输出答案必须在 int<br> 范围之内。</p>\n<p>数据范围<br>1≤n≤105<br>,<br>1≤ai,bi,mi≤2×109<br>输入样例：<br>2<br>2 3 6<br>4 3 5<br>输出样例：<br>impossible<br>-3</p>\n<h1 id=\"前置知识\"><a href=\"#前置知识\" class=\"headerlink\" title=\"前置知识\"></a>前置知识</h1><p>需要用到扩展欧几里得定理<br><img src=\"../images/Acwing/867/describe.jpg\" alt=\"\"></p>\n</blockquote>\n<h1 id=\"代码如下\"><a href=\"#代码如下\" class=\"headerlink\" title=\"代码如下\"></a>代码如下</h1><pre><code class=\"lang-java\">import java.io.*;\nclass Main&#123;\n    static int[] x = new int[1];\n    static int[] y = new int[1];\n    public static int exgcd(int a,int b,int x[],int y[])&#123;\n        if(b==0)&#123;\n            x[0]=1;\n            y[0]=0;\n            return a;\n        &#125;\n\n            int d = exgcd(b,a%b,y,x);\n            y[0] = y[0]- a/b * x[0];\n            return d;\n    &#125;\n    public static void main(String[] args) throws IOException&#123;\n        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n        int cnt = Integer.parseInt(br.readLine());\n        while(cnt--&gt;0)&#123;\n            int a,b,m;\n            String[] content = br.readLine().split(&quot; &quot;);\n            a = Integer.parseInt(content[0]);\n            b = Integer.parseInt(content[1]);\n            m = Integer.parseInt(content[2]);\n            int d = exgcd(a,m,x,y);\n            if(b % d!=0)\n                System.out.println(&quot;impossible&quot;);\n            else \n\n                System.out.printf(&quot;%d\\n&quot;,(long)(b/d)*x[0] % m);\n                /* 上一行的解释\n                    我们需要找到 ax =b (mod m)\n                    ax = b\n                       = my + b\n                    ax-my = b\n                    ax+my = b，将y放大-1倍\n                    由欧几里得定理可得，ax+my = gcd(a,m) 当前仅当 gcd(a,m)|m ,也就是m是gcd(a,m)的倍数，m%gcd(a,m)==0\n                    令gcd(a,m)=d\n                    那么 ax+my = d;①\n                         ax+my = b;②\n                         ①-&gt;②，要将①扩大b/d倍所以\n                         (b/d)(ax+my)=d*(b/d)\n                         (b/d)ax + (b/d)my = b\n                         a(b/d)x + (b/d)my = b\n                         ax                = b\n                         x=(b/d)x，所以只需要将x放大b/d倍即可，两数相乘可能会爆int，所以转换成long类型\n\n                */\n        &#125;\n        br.close();\n        return;\n    &#125;\n&#125;\n</code></pre>\n","feature":true,"text":"题目描述 给定 n 组数据 ai,bi,mi，对于每组数求出一个 xi，使其满足 ai×xi≡bi(modmi)，如果无解则输出 impossible。 输入格...","permalink":"/post/Acwing-867-线性同余方程","photos":[],"count_time":{"symbolsCount":"2.1k","symbolsTime":"2 mins."},"categories":[],"tags":[{"name":"Algorithm","slug":"Algorithm","count":7,"path":"api/tags/Algorithm.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0\"><span class=\"toc-text\">题目描述</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86\"><span class=\"toc-text\">前置知识</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%BB%A3%E7%A0%81%E5%A6%82%E4%B8%8B\"><span class=\"toc-text\">代码如下</span></a></li></ol>","author":{"name":"矽","slug":"blog-author","avatar":"https://ik.imagekit.io/bennyxguo/ObsidianestLogo-hex_hecqbw.png?updatedAt=1692679397324","link":"/","description":"","socials":{"github":"https://github.com/notdy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/qq_45418837","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibli.jpg","link":"https://space.bilibili.com/441747654"}}}},"mapped":true,"hidden":false,"prev_post":{"title":"Acwing-877 扩展欧几里得算法","uid":"f9c782ac3730228558768bfbe2f35bca","slug":"Acwing-877-扩展欧几里得算法","date":"2023-12-19T13:31:45.000Z","updated":"2023-12-19T14:09:41.867Z","comments":true,"path":"api/articles/Acwing-877-扩展欧几里得算法.json","keywords":null,"cover":null,"text":"给定 n 对正整数 ai,bi，对于每对数，求出一组 xi,yi，使其满足 ai×xi+bi×yi=gcd(ai,bi) 输入格式第一行包含整数 n 接下来 n...","permalink":"/post/Acwing-877-扩展欧几里得算法","photos":[],"count_time":{"symbolsCount":"1.3k","symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"Algorithm","slug":"Algorithm","count":7,"path":"api/tags/Algorithm.json"}],"author":{"name":"矽","slug":"blog-author","avatar":"https://ik.imagekit.io/bennyxguo/ObsidianestLogo-hex_hecqbw.png?updatedAt=1692679397324","link":"/","description":"","socials":{"github":"https://github.com/notdy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/qq_45418837","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibli.jpg","link":"https://space.bilibili.com/441747654"}}}},"feature":true},"next_post":{"title":"约数个数","uid":"6f79746afc3c4630b370e421378a0b17","slug":"约数个数","date":"2023-12-14T15:17:55.000Z","updated":"2023-12-14T15:18:57.675Z","comments":true,"path":"api/articles/约数个数.json","keywords":null,"cover":null,"text":"这个是纯粹的欧拉函数转换，原理暂时不太清楚，这周末开始补 import java.io.*; import java.util.*; public class ...","permalink":"/post/约数个数","photos":[],"count_time":{"symbolsCount":831,"symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"Algorithm","slug":"Algorithm","count":7,"path":"api/tags/Algorithm.json"},{"name":"数论","slug":"数论","count":4,"path":"api/tags/数论.json"}],"author":{"name":"矽","slug":"blog-author","avatar":"https://ik.imagekit.io/bennyxguo/ObsidianestLogo-hex_hecqbw.png?updatedAt=1692679397324","link":"/","description":"","socials":{"github":"https://github.com/notdy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/qq_45418837","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibli.jpg","link":"https://space.bilibili.com/441747654"}}}},"feature":true}}